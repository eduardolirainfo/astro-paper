---
import { SITE } from "@config";
import ThemeSelector from "./ThemeSelector.astro";

export interface Props {
  activeNav?: "blog" | "tags" | "sobre" | "pesquisa";
}

const { activeNav } = Astro.props;
---

<header class="fixed z-20 w-full backdrop-blur-md">
  <div class="mx-auto max-w-4xl">
    <nav id="nav-menu" class="top-nav-wrap flex items-center px-2 text-base">
      <a href="/" class="logo pt-2 text-primary">
        <h2
          class="font-mplus text-2xl font-semibold tracking-tighter sm:text-3xl"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="mr-2 inline-block h-8 w-8 sm:mr-0 sm:h-10 sm:w-10"
            viewBox="0 0 20 20"
            stroke="currentColor"
            fill="none"
          >
            <path
              fill-rule="evenodd"
              d="M8.646 5.646a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 8 8.646 6.354a.5.5 0 0 1 0-.708zm-1.292 0a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0 0 .708l2 2a.5.5 0 0 0 .708-.708L5.707 8l1.647-1.646a.5.5 0 0 0 0-.708z"
            ></path>
            <path
              d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"
            ></path>
            <path
              d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"
            ></path>
          </svg>
          {SITE.title}
        </h2>
      </a>
      <button
        class="hamburger-menu focus-outline"
        aria-label="Open Menu"
        aria-expanded="false"
        aria-controls="menu-items"
      >
        <div class="icon-container flex">
          <div id="first-line"></div>
          <div id="second-line"></div>
          <div id="third-line"></div>
        </div>
      </button>
      <ul id="menu-items" class="display-none pt-2 sm:flex">
        <li
          class="gap-1 rounded font-bold normal-case transition duration-300 hover:rounded-lg hover:bg-accent hover:bg-opacity-30 hover:text-current"
        >
          <a href="/blog" class={activeNav === "blog" ? "active" : ""}
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
              ></path></svg
            > Blog</a
          >
        </li>
        <li
          class="gap-1 rounded font-bold normal-case transition duration-300 hover:rounded-lg hover:bg-accent hover:bg-opacity-30 hover:text-current"
        >
          <a href="/tags" class={activeNav === "tags" ? "active" : ""}
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
              ></path></svg
            > Tags</a
          >
        </li>
        <li
          class="gap-1 rounded font-bold normal-case transition duration-300 hover:rounded-lg hover:bg-accent hover:bg-opacity-30 hover:text-current"
        >
          <a href="/sobre" class={activeNav === "sobre" ? "active" : ""}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 48 48"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M37,40H11l-6,6V12c0-3.3,2.7-6,6-6h26c3.3,0,6,2.7,6,6v22C43,37.3,40.3,40,37,40z"
              ></path><path
                fill="currentColor"
                d="M22 20H26V31H22zM24 13A2 2 0 1 0 24 17 2 2 0 1 0 24 13z"
              ></path>
            </svg>
             Sobre
          </a>
        </li>
        <li
          class="gap-1 rounded font-bold normal-case transition duration-300 hover:rounded-lg hover:bg-accent hover:bg-opacity-30 hover:text-current"
        >
          <a
            href="/pesquisa"
            class={`${activeNav === "pesquisa" ? "active" : ""}`}
            title="Pesquisa"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              ><path
                d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"
              ></path>
            </svg>
            <p class="hidden sm:inline">Pesquisa</p>
          </a>
        </li>
        <ThemeSelector />
      </ul>
    </nav>
  </div>
</header>

<style>
  #skip-to-content {
    @apply absolute -top-full left-16 z-50 bg-accent px-3 py-2 text-current transition-all focus:top-4;
  }
  .nav-container {
    @apply mx-auto flex max-w-4xl flex-col items-center justify-between sm:flex-row;
  }
  .top-nav-wrap {
    @apply relative flex w-full items-start justify-between p-0 p-8 sm:items-center sm:py-2;
  }
  .logo {
    @apply absolute py-1 text-xl font-semibold sm:static sm:text-2xl;
  }
  .hamburger-menu {
    @apply self-end p-2 sm:hidden;
  }
  .hamburger-menu svg {
    @apply h-6 w-6 scale-125 bg-base-100;
  }
  nav {
    @apply flex w-full flex-col items-center sm:ml-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0;
  }
  nav ul {
    @apply mt-4 grid w-44 grid-cols-2 grid-rows-4 gap-x-2 gap-y-2 sm:ml-0 sm:mt-0 sm:w-auto sm:gap-x-5 sm:gap-y-0;
  }
  nav ul li {
    @apply col-span-2 flex items-center justify-center;
  }
  nav ul li a {
    @apply w-full px-4 py-3 text-center font-medium hover:text-accent sm:my-0 sm:px-2 sm:py-1;
  }
  nav ul li:nth-child(4) a {
    @apply w-auto;
  }
  nav ul li:nth-child(4),
  nav ul li:nth-child(5) {
    @apply col-span-1;
  }
  nav a.active {
    @apply underline decoration-solid underline-offset-4 hover:decoration-solid;
  }
  nav a.active svg {
    @apply rounded-full bg-accent bg-opacity-30 p-1;
    stroke-width: 2px;
  }
  nav button {
    @apply p-1;
  }
  #theme-btn {
    @apply p-3 sm:p-1;
  }
  .icon-container {
    @apply h-5 w-6 flex-col items-end justify-between text-current;
  }
  .icon-container div {
    @apply h-0.5 text-current transition-all;
  }
  #first-line {
    @apply w-full bg-accent;
  }
  #second-line {
    @apply w-3/4 bg-accent;
  }
  #third-line {
    @apply w-1/2 bg-accent;
  }
</style>

<script>
  function toggleNav() {
    const menuBtn = document.querySelector(".hamburger-menu");
    const menuIcon = document.querySelector(".menu-icon");
    const menuItems = document.querySelector("#menu-items");

    menuBtn?.addEventListener("click", () => {
      const menuExpanded = menuBtn.getAttribute("aria-expanded") === "true";
      menuIcon?.classList.toggle("is-active");
      menuBtn.setAttribute("aria-expanded", menuExpanded ? "false" : "true");
      menuBtn.setAttribute(
        "aria-label",
        menuExpanded ? "Open Menu" : "Close Menu"
      );
      menuItems?.classList.toggle("display-none");
    });
  }

  toggleNav();

  document.addEventListener("astro:after-swap", toggleNav);
</script>
